Select ORG_MAN, GROUPNAME , USERID, USERNAME from (
Select SYS_ORG.*,GROUPS.GROUPNAME,GROUPS.DESCRIPTION,SYS_ORGLEVEL.LEVEL_DESC,USERS.USERID,USERS.USERNAME 
       ,SYS_ORGROLES.ROLE_ID,GROUPS_ROLE.GROUPNAME as ROLE_GROUPNAME,GROUPS_ROLE.DESCRIPTION as ROLE_DESCRIPTION  
from [EEP].[LingYi].[dbo].[SYS_ORG] SYS_ORG 
Left join [EEP].[LingYi].[dbo].[GROUPS] GROUPS on GROUPS.GROUPID=SYS_ORG.ORG_MAN 
left join [EEP].[LingYi].[dbo].[SYS_ORGLEVEL] SYS_ORGLEVEL on SYS_ORGLEVEL.LEVEL_NO=SYS_ORG.LEVEL_NO 
left join [EEP].[LingYi].[dbo].[SYS_ORGROLES] SYS_ORGROLES on SYS_ORGROLES.ORG_NO=SYS_ORG.ORG_NO 
Left join [EEP].[LingYi].[dbo].[GROUPS] GROUPS_ROLE on GROUPS_ROLE.GROUPID=SYS_ORGROLES.ROLE_ID 
Left join [EEP].[LingYi].[dbo].[USERGROUPS] USERGROUPS  on USERGROUPS.GROUPID=SYS_ORG.ORG_MAN 
Left join [EEP].[LingYi].[dbo].[USERS] USERS on USERGROUPS.USERID=USERS.USERID
where 1=1
and SYS_ORG.ORG_NO like '%LVLA%'  and SYS_ORG.ORG_DESC not like 'B%' 
 and SYS_ORG.ORG_KIND = '1000' ) ORG_MAN
where GROUPNAME not like '總人資%' and GROUPNAME not like 'A 醫務室%' and GROUPNAME not like 'A 工團%'
--order by GROUPS.GROUPNAME--, SYS_ORG.ORG_DESC--,  SYS_ORG.LEVEL_NO desc 
union all 
 Select ROLE_ID, ROLE_GROUPNAME, USERS.USERID, USERS.USERNAME from (
Select SYS_ORG.*,GROUPS.GROUPNAME,GROUPS.DESCRIPTION,SYS_ORGLEVEL.LEVEL_DESC,USERS.USERID,USERS.USERNAME 
       ,SYS_ORGROLES.ROLE_ID,GROUPS_ROLE.GROUPNAME as ROLE_GROUPNAME,GROUPS_ROLE.DESCRIPTION as ROLE_DESCRIPTION  
from [EEP].[LingYi].[dbo].[SYS_ORG] SYS_ORG 
Left join [EEP].[LingYi].[dbo].[GROUPS] GROUPS on GROUPS.GROUPID=SYS_ORG.ORG_MAN 
left join [EEP].[LingYi].[dbo].[SYS_ORGLEVEL] SYS_ORGLEVEL on SYS_ORGLEVEL.LEVEL_NO=SYS_ORG.LEVEL_NO 
left join [EEP].[LingYi].[dbo].[SYS_ORGROLES] SYS_ORGROLES on SYS_ORGROLES.ORG_NO=SYS_ORG.ORG_NO 
Left join [EEP].[LingYi].[dbo].[GROUPS] GROUPS_ROLE on GROUPS_ROLE.GROUPID=SYS_ORGROLES.ROLE_ID 
Left join [EEP].[LingYi].[dbo].[USERGROUPS] USERGROUPS  on USERGROUPS.GROUPID=SYS_ORG.ORG_MAN 
Left join [EEP].[LingYi].[dbo].[USERS] USERS on USERGROUPS.USERID=USERS.USERID
where 1=1
and SYS_ORG.ORG_NO like '%LVLA%'  and SYS_ORG.ORG_DESC not like 'B%' and ROLE_ID is not null
and SYS_ORG.ORG_KIND = '1000' ) ORG_MAN
Left join [EEP].[LingYi].[dbo].[USERGROUPS] USERGROUPS  on USERGROUPS.GROUPID=ORG_MAN.ROLE_ID
Left join [EEP].[LingYi].[dbo].[USERS] USERS on USERGROUPS.USERID=USERS.USERID
where GROUPNAME not like '總人資%' and GROUPNAME not like 'A 醫務室%' and GROUPNAME not like 'A 工團%'
