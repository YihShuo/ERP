object OutsolePlanOrderRpt: TOutsolePlanOrderRpt
  Left = 215
  Top = 142
  Width = 1375
  Height = 746
  Caption = 'OutsolePlanOrderRpt'
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  FormStyle = fsMDIChild
  OldCreateOrder = False
  Position = poDefault
  Visible = True
  WindowState = wsMaximized
  OnClose = FormClose
  OnCreate = FormCreate
  OnDestroy = FormDestroy
  PixelsPerInch = 96
  TextHeight = 13
  object Splitter1: TSplitter
    Left = 481
    Top = 75
    Width = 4
    Height = 640
  end
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 1367
    Height = 75
    Align = alTop
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clWindowText
    Font.Height = -13
    Font.Name = 'MS Sans Serif'
    Font.Style = []
    ParentFont = False
    TabOrder = 0
    object Label1: TLabel
      Left = 203
      Top = 14
      Width = 42
      Height = 16
      Caption = 'DDBH:'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      ParentFont = False
    end
    object Label5: TLabel
      Left = 34
      Top = 14
      Width = 47
      Height = 16
      Caption = 'Buy No:'
    end
    object Label3: TLabel
      Left = 203
      Top = 46
      Width = 44
      Height = 16
      Caption = 'DDMH:'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      ParentFont = False
    end
    object Label4: TLabel
      Left = 386
      Top = 13
      Width = 39
      Height = 16
      Caption = 'CKBH:'
    end
    object Label2: TLabel
      Left = 13
      Top = 42
      Width = 69
      Height = 16
      Caption = 'Order Type'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      ParentFont = False
    end
    object BuyNoEdit: TEdit
      Left = 86
      Top = 11
      Width = 115
      Height = 24
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      ParentFont = False
      TabOrder = 0
      Text = '202001'
    end
    object Button2: TButton
      Left = 839
      Top = 39
      Width = 73
      Height = 33
      Caption = 'Query'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      ParentFont = False
      TabOrder = 1
      OnClick = Button2Click
    end
    object DDBHEdit: TEdit
      Left = 250
      Top = 9
      Width = 127
      Height = 24
      CharCase = ecUpperCase
      TabOrder = 2
    end
    object Button3: TButton
      Left = 839
      Top = 4
      Width = 73
      Height = 36
      Caption = 'Excel'
      TabOrder = 3
      OnClick = Button3Click
    end
    object DDMHEdit: TEdit
      Left = 250
      Top = 41
      Width = 127
      Height = 24
      CharCase = ecUpperCase
      TabOrder = 4
    end
    object CBX1: TComboBox
      Left = 427
      Top = 9
      Width = 94
      Height = 24
      Style = csDropDownList
      ItemHeight = 16
      TabOrder = 5
      Items.Strings = (
        'All')
    end
    object WHCKBox: TCheckBox
      Left = 398
      Top = 36
      Width = 86
      Height = 17
      Caption = 'Not in WH'
      TabOrder = 6
    end
    object GroupBox1: TGroupBox
      Left = 520
      Top = 22
      Width = 313
      Height = 49
      Caption = 'Date'
      TabOrder = 7
      object Label8: TLabel
        Left = 3
        Top = 20
        Width = 46
        Height = 16
        AutoSize = False
        Caption = #25505#36092#26085':'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -13
        Font.Name = 'MS Sans Serif'
        Font.Style = []
        ParentFont = False
      end
      object Label7: TLabel
        Left = 98
        Top = 20
        Width = 63
        Height = 16
        AutoSize = False
        Caption = #19968#33324#35330#21934':'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -13
        Font.Name = 'MS Sans Serif'
        Font.Style = []
        ParentFont = False
      end
      object Label6: TLabel
        Left = 202
        Top = 19
        Width = 63
        Height = 16
        AutoSize = False
        Caption = #24555#36895#35330#21934':'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -13
        Font.Name = 'MS Sans Serif'
        Font.Style = []
        ParentFont = False
      end
      object SpinEdit1: TSpinEdit
        Left = 56
        Top = 16
        Width = 41
        Height = 26
        MaxValue = 0
        MinValue = 0
        TabOrder = 0
        Value = 7
      end
      object SpinEdit2: TSpinEdit
        Left = 161
        Top = 14
        Width = 41
        Height = 26
        MaxValue = 0
        MinValue = 0
        TabOrder = 1
        Value = -15
      end
      object SpinEdit3: TSpinEdit
        Left = 267
        Top = 16
        Width = 41
        Height = 26
        MaxValue = 0
        MinValue = 0
        TabOrder = 2
        Value = -7
      end
    end
    object RYTypeCB: TComboBox
      Left = 86
      Top = 40
      Width = 113
      Height = 24
      ItemHeight = 16
      ItemIndex = 0
      TabOrder = 8
      Text = 'All'
      Items.Strings = (
        'All'
        'Normal Order'
        'Quick Order')
    end
    object PriorityCK: TCheckBox
      Left = 398
      Top = 53
      Width = 97
      Height = 17
      Caption = 'Priority GAC'
      Checked = True
      State = cbChecked
      TabOrder = 9
    end
  end
  object Panel2: TPanel
    Left = 0
    Top = 75
    Width = 481
    Height = 640
    Align = alLeft
    Caption = 'Panel2'
    TabOrder = 1
    object Splitter2: TSplitter
      Left = 1
      Top = 233
      Width = 479
      Height = 3
      Cursor = crVSplit
      Align = alTop
    end
    object DBGridEh1: TDBGridEh
      Left = 1
      Top = 1
      Width = 479
      Height = 232
      Align = alTop
      DataSource = DS1
      Flat = False
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      FooterColor = clWindow
      FooterFont.Charset = DEFAULT_CHARSET
      FooterFont.Color = clWindowText
      FooterFont.Height = -11
      FooterFont.Name = 'MS Sans Serif'
      FooterFont.Style = []
      FooterRowCount = 1
      ParentFont = False
      PopupMenu = PopupMenu
      SumList.Active = True
      TabOrder = 0
      TitleFont.Charset = DEFAULT_CHARSET
      TitleFont.Color = clWindowText
      TitleFont.Height = -13
      TitleFont.Name = 'MS Sans Serif'
      TitleFont.Style = []
      UseMultiTitle = True
      OnGetCellParams = DBGridEh1GetCellParams
      Columns = <
        item
          EditButtons = <>
          FieldName = 'DDMH'
          Footer.FieldName = 'DDMH'
          Footer.ValueType = fvtCount
          Footers = <>
          Title.Caption = #24213#27169'|DDMH'
          Width = 112
        end
        item
          EditButtons = <>
          FieldName = 'Pairs'
          Footer.FieldName = 'Pairs'
          Footer.ValueType = fvtSum
          Footers = <>
          Title.Caption = #35330#21934#38617#25976'|Pairs'
          Width = 70
        end
        item
          EditButtons = <>
          FieldName = 'ProdDays1'
          Footers = <>
          Title.Caption = #29983#29986#22825#25976'|ProdDays1'
          Width = 76
        end>
    end
    object DBGridEh2: TDBGridEh
      Left = 1
      Top = 236
      Width = 479
      Height = 403
      Align = alClient
      DataSource = DS2
      Flat = False
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      FooterColor = clWindow
      FooterFont.Charset = DEFAULT_CHARSET
      FooterFont.Color = clWindowText
      FooterFont.Height = -11
      FooterFont.Name = 'MS Sans Serif'
      FooterFont.Style = []
      FooterRowCount = 1
      ParentFont = False
      PopupMenu = PopupMenu1
      SumList.Active = True
      TabOrder = 1
      TitleFont.Charset = DEFAULT_CHARSET
      TitleFont.Color = clWindowText
      TitleFont.Height = -11
      TitleFont.Name = 'MS Sans Serif'
      TitleFont.Style = []
      UseMultiTitle = True
      OnGetCellParams = DBGridEh2GetCellParams
      Columns = <
        item
          EditButtons = <>
          FieldName = 'DDMH'
          Footers = <>
          Title.Caption = #24213#27169'|DDMH'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
          Width = 74
        end
        item
          EditButtons = <>
          FieldName = 'GJCC'
          Footers = <>
          Title.Caption = #24213#27169#23610#30908'|GJCC'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
          Width = 60
        end
        item
          EditButtons = <>
          FieldName = 'Pairs'
          Footer.FieldName = 'Pairs'
          Footer.ValueType = fvtSum
          Footers = <>
          Title.Caption = #35330#21934#38617#25976'|Pairs'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
          Width = 58
        end
        item
          EditButtons = <>
          FieldName = 'OutSoleQty'
          Footer.FieldName = 'OutSoleQty'
          Footer.ValueType = fvtSum
          Footers = <>
          Title.Caption = #24213#27169#25976'|OutSoleQty'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
          Width = 51
        end
        item
          EditButtons = <>
          FieldName = 'OutsoleQty1Day'
          Footers = <>
          Title.Caption = #26085#29986#33021'|OutsoleQty1Day'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
          Width = 60
        end
        item
          EditButtons = <>
          FieldName = 'ProdDays1'
          Footers = <>
          Title.Caption = #22825#29986#22825#25976'|ProdDays'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
        end
        item
          EditButtons = <>
          FieldName = 'NeedQtyOutsole'
          Footers = <>
          Title.Caption = #38656#24213#27169#25976'|NeedQtyOutsole'
          Title.Font.Charset = DEFAULT_CHARSET
          Title.Font.Color = clWindowText
          Title.Font.Height = -13
          Title.Font.Name = 'MS Sans Serif'
          Title.Font.Style = []
          Width = 54
        end>
    end
  end
  object DBGridEh3: TDBGridEh
    Left = 485
    Top = 75
    Width = 882
    Height = 640
    Align = alClient
    DataSource = DS3
    Flat = False
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clWindowText
    Font.Height = -13
    Font.Name = 'MS Sans Serif'
    Font.Style = []
    FooterColor = clWindow
    FooterFont.Charset = DEFAULT_CHARSET
    FooterFont.Color = clWindowText
    FooterFont.Height = -11
    FooterFont.Name = 'MS Sans Serif'
    FooterFont.Style = []
    FooterRowCount = 1
    ParentFont = False
    PopupMenu = PopupMenu2
    SumList.Active = True
    TabOrder = 2
    TitleFont.Charset = DEFAULT_CHARSET
    TitleFont.Color = clWindowText
    TitleFont.Height = -11
    TitleFont.Name = 'MS Sans Serif'
    TitleFont.Style = []
    UseMultiTitle = True
    OnGetCellParams = DBGridEh3GetCellParams
    Columns = <
      item
        EditButtons = <>
        FieldName = 'BUYNO'
        Footers = <>
        Title.Caption = 'BUY NO'#21029'|BUYNO'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 77
      end
      item
        EditButtons = <>
        FieldName = 'DDBH'
        Footers = <>
        Title.Caption = #35330#21934#32232#34399'|DDBH'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 80
      end
      item
        EditButtons = <>
        FieldName = 'ARTICLE'
        Footers = <>
        Title.Caption = 'SKU#|ARTICLE'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 101
      end
      item
        EditButtons = <>
        FieldName = 'DDZT'
        Footers = <>
        Title.Caption = #29376#24907'|DDZT'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 33
      end
      item
        EditButtons = <>
        FieldName = 'RYTYPE'
        Footers = <>
        Title.Caption = #24555#36895#35330#21934'|RYTYPE'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 47
      end
      item
        EditButtons = <>
        FieldName = 'CC'
        Footers = <>
        Title.Caption = #35330#21934#23610#30908'|CC'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 52
      end
      item
        EditButtons = <>
        FieldName = 'GJCC'
        Footers = <>
        Title.Caption = #24213#27169#23610#30908'|GJCC'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 59
      end
      item
        EditButtons = <>
        FieldName = 'Quantity'
        Footer.FieldName = 'Quantity'
        Footer.ValueType = fvtSum
        Footers = <>
        Title.Caption = #35330#21934#38617#25976'|Quantity'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 52
      end
      item
        EditButtons = <>
        FieldName = 'DDRQ'
        Footers = <>
        Title.Caption = #25509#21934#26085'|DDRQ'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 65
      end
      item
        EditButtons = <>
        FieldName = 'DDRQ7'
        Footers = <>
        Title.Caption = #25505#36092#19979#21934'|DDRQ+7'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 69
      end
      item
        EditButtons = <>
        FieldName = 'ShipDate'
        Footers = <>
        Title.Caption = #20986#36008#26085'|ShipDate'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 74
      end
      item
        EditButtons = <>
        FieldName = 'Days'
        Footers = <>
        Title.Caption = #22825#25976'|Days'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 38
      end
      item
        EditButtons = <>
        FieldName = 'DDMH'
        Footers = <>
        Title.Caption = #24213#27169'|DDMH'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 149
      end
      item
        EditButtons = <>
        FieldName = 'DDGB'
        Footers = <>
        Title.Caption = #20986#36008#22283#23478'|DDGB'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 47
      end
      item
        EditButtons = <>
        FieldName = 'YN'
        Footers = <>
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 22
      end
      item
        EditButtons = <>
        FieldName = 'RN'
        Footers = <>
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 49
      end
      item
        EditButtons = <>
        FieldName = 'OutsoleQty'
        Footers = <>
        Title.Caption = #24213#27169#25976'|OutsoleQty'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 41
      end
      item
        EditButtons = <>
        FieldName = 'OutsoleQty1Day'
        Footers = <>
        Title.Caption = #24213#27169#26085#29986#33021'|OutsoleQty1Day'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
      end
      item
        EditButtons = <>
        FieldName = 'PlanDate'
        Footers = <>
        Title.Caption = #38928#35336#19978#32218#26085'|PlanDate'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 70
      end
      item
        EditButtons = <>
        FieldName = 'SumQty'
        Footers = <>
        Title.Caption = #32047#35336#38617#25976'|SumQty'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 68
      end
      item
        EditButtons = <>
        FieldName = 'RDDate'
        Footers = <>
        Title.Caption = #38928#35336#23436#25104#26085'|RDDate'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 66
      end
      item
        EditButtons = <>
        FieldName = 'Flag'
        Footers = <>
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 43
      end
      item
        EditButtons = <>
        FieldName = 'SumQty1'
        Footers = <>
        Title.Caption = #32047#35336#38617#25976'|SumQty1'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 68
      end
      item
        EditButtons = <>
        FieldName = 'RDDate1'
        Footers = <>
        Title.Caption = #38928#35336#23436#25104#26085'|RDDate1'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 69
      end
      item
        EditButtons = <>
        FieldName = 'Flag1'
        Footers = <>
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Visible = False
        Width = 51
      end
      item
        EditButtons = <>
        FieldName = 'ProdDays'
        Footers = <>
        Title.Caption = #24179#22343#22825#25976'|ProdDays'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 65
      end
      item
        EditButtons = <>
        FieldName = 'ProdDays1'
        Footers = <>
        Title.Caption = #29983#29986#22825#25976'|ProdDays1'
        Title.Font.Charset = DEFAULT_CHARSET
        Title.Font.Color = clWindowText
        Title.Font.Height = -13
        Title.Font.Name = 'MS Sans Serif'
        Title.Font.Style = []
        Width = 65
      end>
  end
  object OutsoleQry: TQuery
    DatabaseName = 'DB'
    SQL.Strings = (
      
        'select DDMH,Sum(Quantity) as Pairs,Min(Flag1) as Flag1,MAX(ProdD' +
        'ays1) as ProdDays1 from ('
      ''
      ''
      
        'select tmpDDMH.*,DATEADD(day,SumQty1/OutsoleQty1Day,DDRQ7) as RD' +
        'Date1,Round(SumQty1/Convert(float,OutsoleQty1Day),2) as ProdDays' +
        '1,case when DATEADD(day,SumQty1/OutsoleQty1Day,DDRQ7)<=PlanDate ' +
        'then 1 else 0 end as Flag1 '
      'from ('
      'SELECT *'
      
        '      ,(select SUM(Quantity) from #tmpDDMH2 b1 where b1.RN<=a1.R' +
        'N and b1.RDDate>=a1.DDRQ7 and b1.GJCC=a1.GJCC  and a1.DDMH=b1.DD' +
        'MH) as SumQty1 '
      
        '      --,(select Sum(OutSoleQty) from (select GJCC,OutSoleQty fr' +
        'om #tmpDDMH2 c1 where c1.DDMH=a1.DDMH Group by GJCC,OutSoleQty) ' +
        'd1 ) as TotalOutSoleQty'
      
        '      --,(select Sum(OutSoleQty) from (select GJCC,OutSoleQty* f' +
        'rom #tmpDDMH2 c1 where c1.DDMH=a1.DDMH Group by GJCC,OutSoleQty)' +
        ' d1 ) as TotalOutSoleQty'
      'FROM #tmpDDMH2 a1'
      'where  1=1 and GJCC='#39'06.0'#39
      ' ) tmpDDMH '
      ' --order by RN'
      ' '
      ' ) tmpDDMH'
      'Group by DDMH '
      'order by MIN(Flag1),DDMH')
    Left = 200
    Top = 190
    object OutsoleQryDDMH: TStringField
      FieldName = 'DDMH'
      FixedChar = True
      Size = 30
    end
    object OutsoleQryPairs: TIntegerField
      FieldName = 'Pairs'
    end
    object OutsoleQryProdDays1: TFloatField
      FieldName = 'ProdDays1'
    end
    object OutsoleQryFlag1: TIntegerField
      FieldName = 'Flag1'
    end
  end
  object DS1: TDataSource
    DataSet = OutsoleQry
    Left = 200
    Top = 223
  end
  object DDZLSQry: TQuery
    DatabaseName = 'DB'
    DataSource = DS2
    SQL.Strings = (
      
        'select tmpDDMH.*,DATEADD(day,SumQty1/OutsoleQty1Day,DDRQ7) as RD' +
        'Date1,case when DATEADD(day,SumQty1/OutsoleQty1Day,DDRQ7)<=PlanD' +
        'ate then 1 else 0 end as Flag1,'
      
        '       Round(SumQty/Convert(float,OutsoleQty1Day),2) as ProdDays' +
        ',Round(SumQty1/Convert(float,OutsoleQty1Day),2) as ProdDays1'
      'from ('
      'SELECT *'
      
        '      ,(select SUM(Quantity) from #tmpDDMH2 b1 where b1.RN<=a1.R' +
        'N and b1.RDDate>=a1.DDRQ7 and b1.GJCC=a1.GJCC  and a1.DDMH=b1.DD' +
        'MH) as SumQty1 '
      'FROM #tmpDDMH2 a1'
      'where a1.DDMH=:DDMH  and a1.GJCC=:GJCC'
      ' ) tmpDDMH'
      'where 1=1'
      'order by RN')
    Left = 276
    Top = 190
    ParamData = <
      item
        DataType = ftFixedChar
        Name = 'DDMH'
        ParamType = ptUnknown
        Size = 31
      end
      item
        DataType = ftFixedChar
        Name = 'GJCC'
        ParamType = ptUnknown
        Size = 7
      end>
    object DDZLSQryBUYNO: TStringField
      FieldName = 'BUYNO'
      FixedChar = True
      Size = 10
    end
    object DDZLSQryDDBH: TStringField
      FieldName = 'DDBH'
      FixedChar = True
      Size = 15
    end
    object DDZLSQryARTICLE: TStringField
      FieldName = 'ARTICLE'
      FixedChar = True
    end
    object DDZLSQryDDZT: TStringField
      FieldName = 'DDZT'
      FixedChar = True
      Size = 1
    end
    object DDZLSQryRYTYPE: TStringField
      FieldName = 'RYTYPE'
      FixedChar = True
      Size = 10
    end
    object DDZLSQryCC: TStringField
      FieldName = 'CC'
      FixedChar = True
      Size = 6
    end
    object DDZLSQryGJCC: TStringField
      FieldName = 'GJCC'
      FixedChar = True
      Size = 6
    end
    object DDZLSQryQuantity: TIntegerField
      FieldName = 'Quantity'
    end
    object DDZLSQryDDRQ: TDateTimeField
      FieldName = 'DDRQ'
    end
    object DDZLSQryDDRQ7: TDateTimeField
      FieldName = 'DDRQ7'
    end
    object DDZLSQryShipDate: TDateTimeField
      FieldName = 'ShipDate'
    end
    object DDZLSQryDays: TIntegerField
      FieldName = 'Days'
    end
    object DDZLSQryDDMH: TStringField
      FieldName = 'DDMH'
      FixedChar = True
      Size = 30
    end
    object DDZLSQryDDGB: TStringField
      FieldName = 'DDGB'
      FixedChar = True
      Size = 4
    end
    object DDZLSQryYN: TStringField
      FieldName = 'YN'
      FixedChar = True
      Size = 1
    end
    object DDZLSQryRN: TFloatField
      FieldName = 'RN'
    end
    object DDZLSQryOutsoleQty: TFloatField
      FieldName = 'OutsoleQty'
    end
    object DDZLSQryOutsoleQty1Day: TFloatField
      FieldName = 'OutsoleQty1Day'
    end
    object DDZLSQryPlanDate: TDateTimeField
      FieldName = 'PlanDate'
    end
    object DDZLSQrySumQty: TIntegerField
      FieldName = 'SumQty'
    end
    object DDZLSQryRDDate: TDateTimeField
      FieldName = 'RDDate'
    end
    object DDZLSQryFlag: TIntegerField
      FieldName = 'Flag'
    end
    object DDZLSQrySumQty1: TIntegerField
      FieldName = 'SumQty1'
    end
    object DDZLSQryRDDate1: TDateTimeField
      FieldName = 'RDDate1'
    end
    object DDZLSQryFlag1: TIntegerField
      FieldName = 'Flag1'
    end
    object DDZLSQryProdDays: TFloatField
      FieldName = 'ProdDays'
    end
    object DDZLSQryProdDays1: TFloatField
      FieldName = 'ProdDays1'
    end
  end
  object DS3: TDataSource
    DataSet = DDZLSQry
    Left = 276
    Top = 223
  end
  object QTemp: TQuery
    DatabaseName = 'DB'
    SQL.Strings = (
      'if object_id('#39'tempdb..#tmpDDMH'#39') is not null'
      'begin   drop table #tmpDDMH end     '
      
        'Select DDZL.*,OutsoleS.DQty as OutsoleQty,OutsoleS.DQty*OutsoleS' +
        '.OutsoleQty1Day as OutsoleQty1Day  into #tmpDDMH  from ('
      
        'Select DDZL.BUYNO,DDZL.DDBH,DDZL.ARTICLE,DDZL.DDZT,DDZL.RYTYPE,D' +
        'DZLS.CC,XXGJS.GJCC,DDZLS.Quantity,DDZL.DDRQ, '
      
        '       DateAdd(Day,7,DDZL.DDRQ) as DDRQ7,DDZL.ShipDate,DateDiff(' +
        'Day,DDZL.DDRQ,DDZL.ShipDate) as Days,XXZL.DDMH,DDZL.DDGB,DDZL.YN' +
        ',ROW_NUMBER() over (PARTITION BY DDMH,GJCC  ORDER BY shipdate,DD' +
        'RQ,GJCC) as RN from DDZL'
      'left join DDZLs on DDZLS.DDBH=DDZL.DDBH '
      'left join SCZLDate on SCZLDate.ZLBH=DDZL.DDBH '
      
        'Left join XXZL on XXZL.XieXing=DDZL.XieXing and XXZL.SheHao=DDZL' +
        '.SheHao '
      
        'left join XXGJS on xxgjs.XieXing=DDZL.XieXing and xxgjs.GJLB=101' +
        ' and xxgjs.XXCC=DDZLs.CC '
      'Where DDZL.DDZT<>'#39'C'#39' and DDZL.DDLB<>'#39'B'#39' and DDZL.GSBH='#39'VA12'#39' '
      '  and DDZL.BUYNO like '#39'202001%'#39' '
      '  and XXZL.DDMH like '#39'TD-009TR%'#39' '
      '    ) DDZL'
      'Left join ('
      
        '  select OutsoleS.*,IsNull(OutsoleSCBZCL.MDPM,CLZL.YWPM) as YWPM' +
        ',OutsoleSCBZCL.Qty as OutsoleQty1Day from ('
      '  select CLBH,SIZ,Sum(RKQty) as DQty from ('
      
        '  select OSRK.CKBH,OSRKSS.CLBH,OSRKSS.SIZ,SUM(OSRKSS.Qty) as RKQ' +
        'ty from OSRKSS,OSRK '
      
        '  where OSRKSS.RKNO=OSRK.RKNO  and OSRK.CKBH='#39'VA12'#39' and OSRKSS.Z' +
        'LBH='#39'NEWL'#39' and convert(smalldatetime,convert(varchar,OSRK.UserDa' +
        'te,111)) between '#39'2020/04/01'#39' and '#39'2020/04/04'#39'  '
      '  Group by OSRK.CKBH,OSRKSS.CLBH,OSRKSS.SIZ '
      '  Union All '
      
        '  select CKBH,CLBH,SIZ,QTY as OutsoleRem from Outsolemonth where' +
        ' CKBH='#39'VA12#L'#39' and KCYEAR='#39'2020'#39' and KCMonth='#39'03'#39'  ) as tmpRKTLF' +
        'L '
      '  group by CKBH,CLBH,SIZ ) OutsoleS'
      '  left join CLZL on CLZL.cldh=OutSoleS.CLBH'
      '  left join OutsoleSCBZCL on OutsoleSCBZCL.CLDH=OutSoleS.CLBH'
      
        ') OutsoleS on OutsoleS.YWPM=DDZL.DDMH and OutsoleS.SIZ=DDZL.GJCC' +
        ' '
      'if object_id('#39'tempdb..#tmpDDMH2'#39') is not null'
      'begin   drop table #tmpDDMH2 end  '
      
        'select tmpDDMH.*,DATEADD(day,SumQty/OutsoleQty1Day,DDRQ7) as RDD' +
        'ate,case when DATEADD(day,SumQty/OutsoleQty1Day,DDRQ7)<=PlanDate' +
        ' then 1 else 0 end as Flag  into #tmpDDMH2'
      'from ('
      'SELECT *'
      
        '      ,case when IsNull(a1.RYTYPE,'#39#39')<>'#39'SLT'#39' then DATEADD(day,-1' +
        '5,shipdate) else  DATEADD(day,-7,shipdate) end as PlanDate'
      
        '      ,(select SUM(Quantity) from #tmpDDMH b1 where b1.RN<=a1.RN' +
        ' and b1.GJCC=a1.GJCC and a1.DDMH=b1.DDMH) as SumQty  '
      'FROM #tmpDDMH a1 ) tmpDDMH'
      'order by DDRQ,PlanDate')
    Left = 200
    Top = 160
  end
  object OutsoleSQry: TQuery
    DatabaseName = 'DB'
    DataSource = DS1
    SQL.Strings = (
      
        'select DDMH,GJCC,Sum(Quantity) as Pairs,OutSoleQty ,OutsoleQty1D' +
        'ay,MAX(ProdDays1) as ProdDays1 ,MIN(Flag1) as Flag1'
      
        '       ,Round(max(sumQty1/(OutsoleQty1Day/OutsoleQty)/Datediff(d' +
        'ay,DDRQ7,PlanDate)),0) as NeedQtyOutsole'
      ' from ('
      
        'select tmpDDMH.*,DATEADD(day,SumQty1/OutsoleQty1Day,DDRQ7) as RD' +
        'Date1,Round(SumQty1/Convert(float,OutsoleQty1Day),2) as ProdDays' +
        '1,case when DATEADD(day,SumQty1/OutsoleQty1Day,DDRQ7)<=PlanDate ' +
        'then 1 else 0 end as Flag1 '
      'from ('
      'SELECT *'
      
        '      ,(select SUM(Quantity) from #tmpDDMH2 b1 where b1.RN<=a1.R' +
        'N and b1.RDDate>=a1.DDRQ7 and b1.GJCC=a1.GJCC  and a1.DDMH=b1.DD' +
        'MH) as SumQty1 '
      'FROM #tmpDDMH2 a1'
      'where a1.DDMH='#39'TD-009TR'#39' and a1.GJCC='#39'06.0'#39
      ' ) tmpDDMH ) tmpDDMH'
      'Group by DDMH,GJCC,OutsoleQty1Day,OutSoleQty '
      'order by GJCC asc')
    Left = 240
    Top = 190
    object OutsoleSQryDDMH: TStringField
      FieldName = 'DDMH'
      FixedChar = True
      Size = 30
    end
    object OutsoleSQryGJCC: TStringField
      FieldName = 'GJCC'
      FixedChar = True
      Size = 6
    end
    object OutsoleSQryPairs: TIntegerField
      FieldName = 'Pairs'
    end
    object OutsoleSQryOutSoleQty: TFloatField
      FieldName = 'OutSoleQty'
    end
    object OutsoleSQryOutsoleQty1Day: TFloatField
      FieldName = 'OutsoleQty1Day'
    end
    object OutsoleSQryFlag1: TIntegerField
      FieldName = 'Flag1'
    end
    object OutsoleSQryProdDays1: TFloatField
      FieldName = 'ProdDays1'
    end
    object OutsoleSQryNeedQtyOutsole: TFloatField
      FieldName = 'NeedQtyOutsole'
    end
  end
  object DS2: TDataSource
    DataSet = OutsoleSQry
    Left = 240
    Top = 223
  end
  object PopupMenu2: TPopupMenu
    Left = 279
    Top = 260
    object mnu1: TMenuItem
      Caption = 'Excel'
      OnClick = mnu1Click
    end
    object N1: TMenuItem
      Caption = '-'
    end
    object mnu2: TMenuItem
      Caption = 'Filter Red Order'
      OnClick = mnu2Click
    end
  end
  object PopupMenu1: TPopupMenu
    Left = 240
    Top = 259
    object Excel1: TMenuItem
      Caption = 'Excel'
      OnClick = Excel1Click
    end
  end
  object PopupMenu: TPopupMenu
    Left = 200
    Top = 259
    object MenuItem1: TMenuItem
      Caption = 'Excel'
      OnClick = MenuItem1Click
    end
  end
  object ExcelQuery: TQuery
    DatabaseName = 'DB'
    SQL.Strings = (
      'if object_id('#39'tempdb..#tmpDDMH'#39') is not null'
      'begin   drop table #tmpDDMH end     '
      
        'Select DDZL.*,OutsoleS.DQty as OutsoleQty,OutsoleS.DQty*OutsoleS' +
        '.OutsoleQty1Day as OutsoleQty1Day  into #tmpDDMH  from ('
      
        'Select DDZL.BUYNO,DDZL.DDBH,DDZL.ARTICLE,DDZL.DDZT,DDZL.RYTYPE,D' +
        'DZLS.CC,XXGJS.GJCC,DDZLS.Quantity,DDZL.DDRQ, '
      
        '       DateAdd(Day,7,DDZL.DDRQ) as DDRQ7,DDZL.ShipDate,DateDiff(' +
        'Day,DDZL.DDRQ,DDZL.ShipDate) as Days,XXZL.DDMH,DDZL.DDGB,DDZL.YN' +
        ',ROW_NUMBER() over (PARTITION BY DDMH,GJCC  ORDER BY shipdate,DD' +
        'RQ,GJCC) as RN from DDZL'
      'left join DDZLs on DDZLS.DDBH=DDZL.DDBH '
      'left join SCZLDate on SCZLDate.ZLBH=DDZL.DDBH '
      
        'Left join XXZL on XXZL.XieXing=DDZL.XieXing and XXZL.SheHao=DDZL' +
        '.SheHao '
      
        'left join XXGJS on xxgjs.XieXing=DDZL.XieXing and xxgjs.GJLB=101' +
        ' and xxgjs.XXCC=DDZLs.CC '
      'Where DDZL.DDZT<>'#39'C'#39' and DDZL.DDLB<>'#39'B'#39' and DDZL.GSBH='#39'VA12'#39' '
      '  and DDZL.BUYNO like '#39'202001%'#39' '
      '  and XXZL.DDMH like '#39'TD-009TR%'#39' '
      '    ) DDZL'
      'Left join ('
      
        '  select OutsoleS.*,IsNull(OutsoleSCBZCL.MDPM,CLZL.YWPM) as YWPM' +
        ',OutsoleSCBZCL.Qty as OutsoleQty1Day from ('
      '  select CLBH,SIZ,Sum(RKQty) as DQty from ('
      
        '  select OSRK.CKBH,OSRKSS.CLBH,OSRKSS.SIZ,SUM(OSRKSS.Qty) as RKQ' +
        'ty from OSRKSS,OSRK '
      
        '  where OSRKSS.RKNO=OSRK.RKNO  and OSRK.CKBH='#39'VA12'#39' and OSRKSS.Z' +
        'LBH='#39'NEWL'#39' and convert(smalldatetime,convert(varchar,OSRK.UserDa' +
        'te,111)) between '#39'2020/04/01'#39' and '#39'2020/04/04'#39'  '
      '  Group by OSRK.CKBH,OSRKSS.CLBH,OSRKSS.SIZ '
      '  Union All '
      
        '  select CKBH,CLBH,SIZ,QTY as OutsoleRem from Outsolemonth where' +
        ' CKBH='#39'VA12#L'#39' and KCYEAR='#39'2020'#39' and KCMonth='#39'03'#39'  ) as tmpRKTLF' +
        'L '
      '  group by CKBH,CLBH,SIZ ) OutsoleS'
      '  left join CLZL on CLZL.cldh=OutSoleS.CLBH'
      '  left join OutsoleSCBZCL on OutsoleSCBZCL.CLDH=OutSoleS.CLBH'
      
        ') OutsoleS on OutsoleS.YWPM=DDZL.DDMH and OutsoleS.SIZ=DDZL.GJCC' +
        ' '
      'if object_id('#39'tempdb..#tmpDDMH2'#39') is not null'
      'begin   drop table #tmpDDMH2 end  '
      
        'select tmpDDMH.*,DATEADD(day,SumQty/OutsoleQty1Day,DDRQ7) as RDD' +
        'ate,case when DATEADD(day,SumQty/OutsoleQty1Day,DDRQ7)<=PlanDate' +
        ' then 1 else 0 end as Flag  into #tmpDDMH2'
      'from ('
      'SELECT *'
      
        '      ,case when IsNull(a1.RYTYPE,'#39#39')<>'#39'SLT'#39' then DATEADD(day,-1' +
        '5,shipdate) else  DATEADD(day,-7,shipdate) end as PlanDate'
      
        '      ,(select SUM(Quantity) from #tmpDDMH b1 where b1.RN<=a1.RN' +
        ' and b1.GJCC=a1.GJCC and a1.DDMH=b1.DDMH) as SumQty  '
      'FROM #tmpDDMH a1 ) tmpDDMH'
      'order by DDRQ,PlanDate')
    Left = 160
    Top = 192
  end
end
