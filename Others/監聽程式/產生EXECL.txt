Delphi北Excel氦瑾k

@@1 谦Excelゅン

@@nbDelphiい北ExcelANゲД唯OLE黏啤Ccb@氇謦OLE2S谦OLE炼HA蹇E・@OLE炼H骸AA锞沟{拨be竟{X场E　A贝NO┮i骸ТNaE　ā]in-place activation^C
谦Excelゅン骸A谦丐@OLE炼HAMZb炼Hい廿撙u@worksheetApㄧcreateExcel┮ボG

function createExcel:variant;
var
v:variant;
sheet:variant;
begin
v:=createoleobject('Excel.Application');//谦OLE炼H
v.visible:=true;
v.workbooks.add(-4167); //K[u@
v.workbooks[1].sheets[1].name:='test';
sheet:=v.workbooks[1].sheets['test'];
Result := v;
end; 

@@2 壅u懋姹报

@@Excel懋妾罕报睢ADn]A壅u栅JB拽铩F摔府妾害X}B十鬲罕报睢F懋妾何`睢B诌`单C要懋姒・@w罕栅UA懋妾何`睢B诌`FoぷonA蕖AiH瞌@@ゅン家OAMZ龇r惠nrXh要恣YiC

@@]1^壅u栅J]importData^

procedure importData;
var
I,j:integer;
v:variant;
begin
v:=createExcel; //谦Excelゅンtest
for I:=0 to maxcolumn do
begin
for j:=0 to maxrow do
v.workbooks[1].sheets[1].cells[I,j]:=I*j; //栅J壅u
end;
end; 

@@]2^摔府妾害X}B十鬲罕报睢]lineStylecontrol^

@@摔府妾害X}AObuwX}S溪罕栅Un妾骸C十乇报睽iH巨@十EW含O_FボCㄤLよΑ罕报睢AiHラ酚Ue{n妗C

procedure lineStylecontrol;
var
v,sheet,range:variant;
begin
v:=createExecl;
sheet:= v.workbooks[1].sheets[1];
range:=sheet.range[sheet.cells[1,1],sheet.cells[39,30]];//uw懋
range.select;
range.merge; //X}摔府
range.borders.linestyle:=xlcontinuous; //m十EiN
range.font.size:=9; //э@懋Xゅセr^jp
end; 
@@]3^懋妾何`钌O诌`]copyandPaste^

procedure copyandPaste;
var
v,sheet,range:variant;
begin
v:=createExecl;
sheet:= v.workbooks[1].sheets[1];
range:=sheet.range[sheet.cells[1,1],sheet.cells[39,30]];
range.select; //uwn`瞠邯懋
range.copy; //`uw邯懋
sheet.range[sheet.cells[40,1],sheet.cells[40,1]].select; //u岘n诌`害旄m
sheet.pasteF //诌`懋
end; 

@@3 ゅン韩Os

@@ゅンOsOb谦丐濂螵喊撙Wn妾骸Ae{saveFileSFゅンOse{いG`N_G

procedure saveFile;
var
sheet,v:variant;
begin
v:=createExcel;
if savedialog.execute then
begin
v.workbooks[1].saveas(savedialog.FileName);//Osゅン
v.workbooks[1].close; //袱u@
v.quit; //Excel
v := unassigned;
end;
end; 
