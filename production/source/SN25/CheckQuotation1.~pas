unit CheckQuotation1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, GridsEh, DBGridEh, DB, DBTables;

type
  TCheckQuotation = class(TForm)
    DS1: TDataSource;
    Query1: TQuery;
    Query1BJNO: TStringField;
    Query1CLBH: TStringField;
    Query1USPrice: TCurrencyField;
    Query1ZSYWJC: TStringField;
    Query1VNPrice: TCurrencyField;
    DBGridEh1: TDBGridEh;
    procedure FormCreate(Sender: TObject);
    procedure DBGridEh1DblClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  CheckQuotation: TCheckQuotation;

implementation
 uses main1,ReplenishCon1;
{$R *.dfm}

procedure TCheckQuotation.FormCreate(Sender: TObject);
begin
    with query1 do
    begin
      Active:=false;
      sql.clear;
      sql.Add('select CGBJS.BJNO,CGBJS.CLBH,CGBJS.VNPrice,CGBJS.USPrice,ZSZL.ZSYWJC');
      sql.add('from CGBJS ');
      sql.add('left join CGBJ on CGBJS.BJNO=CGBJ.BJNO');
      sql.add('left join ZSZL on ZSZL.ZSDH=CGBJ.ZSBH ');
      sql.add('where CGBJS.CLBH='''+ReplenishCon.BLDet.FieldValues['CLBH']+'''');
      sql.Add('order by CGBJ.BJNO DESC ');
      active:=true;
    end;
end;

procedure TCheckQuotation.DBGridEh1DblClick(Sender: TObject);
begin
  if query1.recordcount>0 then
  begin
    ReplenishCon.BLDet.Edit;
    //ReplenishCon.BLDet.fieldbyname('VNPrice').Value:=query1.fieldbyname('VNPrice').Value;
    ReplenishCon.BLDet.fieldbyname('USPrice').Value:=query1.fieldbyname('USPrice').Value;
    //MatPrice.query1.post;
  end;
end;

procedure TCheckQuotation.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
  action:=cafree;
end;

end.
