------------------------
Update YWDD  Set InspectQty=A.Pairs,InspectDate=A.EXEDATE,InUSERID='21191',InUSERDATE=GetDate()
from (
	Select * 
	from (
		Select * from (
		Select 'LYN' as factory,isnull(max(BDepartment.sumline),'') as sumline,ddzl.khpo
			   ,'I' as GXLB,YWCP.EXEDATE,ywdd.INSPECTDATE  as datadate
			   ,(sum(ywdd.inspectqty)-isnull(old.yqty,0)) as qty,DDZL.Pairs,DDZL.Pairs-IsNull(sum(ywdd.inspectqty),0) as Diff ,ddzl.ddbh, null as YN
		from ywdd 
		left join ddzl on ywdd.ysbh = ddzl.ddbh and ddzl.DDZT<>'C' 
		left join (select YSBH,max(depno) as depno from SMDD where  GXLB='A' group by YSBH) yp on yp.YSBH=DDZL.DDBH
		left join BDepartment on BDepartment.id=yp.depno
		left join  (select khpo,sum(qty) as yqty from rtstemp 
					where gxlb='I' 
				   group by khpo) as old on old.khpo=ddzl.khpo 
		left join (select DDBH,Max(EXEDATE) as EXEDATE  from YWCP Group by DDBH ) YWCP on YWCP.DDBH=ywdd.DDBH
		where  1=1 
				and ddzl.khbh='036'
				and substring(ddzl.ddbh,1,2)<>'ZS'
				and YWDD.DDBH in 
		('Y2304-0976',
		'Y2303-0598',
		'Y2304-0264',
		'Y2304-0345',
		'Y2304-0358',
		'Y2304-0365',
		'Y2304-0435',
		'Y2303-0279C',
		'Y2304-0268',
		'Y2304-1556',
		'Y2304-1577',
		'Y2304-0516',
		'Y2304-0543',
		'Y2304-0005',
		'Y2304-0006',
		'Y2304-0061',
		'Y2304-0062',
		'Y2304-0063',
		'Y2304-0064',
		'Y2304-0065',
		'Y2304-0453',
		'Y2304-0618',
		'Y2304-0702',
		'Y2304-1080',
		'Y2304-1263',
		'Y2304-1264',
		'Y2304-1266',
		'Y2304-1268',
		'Y2304-1270',
		'Y2304-1272',
		'Y2304-1273',
		'Y2304-1274',
		'Y2304-1275',
		'Y2304-1278',
		'Y2304-1279',
		'Y2304-1281',
		'Y2304-1282',
		'Y2304-1283',
		'Y2304-1288',
		'Y2305-0303',
		'Y2305-0305',
		'Y2305-0306',
		'Y2305-0308',
		'Y2305-0309',
		'Y2305-0310',
		'Y2305-0311',
		'Y2305-0312',
		'Y2305-0315',
		'Y2305-0317',
		'Y2305-0318',
		'Y2305-0322',
		'Y2305-0329',
		'Y2305-0330',
		'Y2305-0331',
		'Y2305-0334',
		'Y2305-0335',
		'Y2305-0337',
		'Y2305-0339',
		'Y2305-0341',
		'Y2305-0342',
		'Y2305-0347',
		'Y2305-0349',
		'Y2305-0350',
		'Y2305-0351',
		'Y2305-0352',
		'Y2305-0353',
		'Y2305-0361',
		'Y2305-0362',
		'Y2305-1099',
		'Y2305-1100',
		'Y2304-0606',
		'Y2304-0607',
		'Y2304-0617',
		'Y2304-0619',
		'Y2304-0620',
		'Y2304-0622',
		'Y2304-0623',
		'Y2304-0624',
		'Y2304-0625',
		'Y2304-0626',
		'Y2304-0627',
		'Y2304-0629',
		'Y2304-0638',
		'Y2304-0639',
		'Y2304-0640',
		'Y2304-0641',
		'Y2304-0642',
		'Y2304-0643',
		'Y2304-0644',
		'Y2304-0645',
		'Y2304-0646',
		'Y2304-0647',
		'Y2304-0648',
		'Y2304-0649',
		'Y2304-0650',
		'Y2304-0651',
		'Y2304-0652',
		'Y2304-0653',
		'Y2304-0658',
		'Y2304-0659',
		'Y2304-0660',
		'Y2304-0661',
		'Y2304-0662',
		'Y2304-0665',
		'Y2304-0667',
		'Y2304-0668',
		'Y2304-0669',
		'Y2304-0670',
		'Y2304-0671',
		'Y2304-0672',
		'Y2304-0673',
		'Y2304-0675',
		'Y2304-0678',
		'Y2304-0679',
		'Y2304-0680',
		'Y2304-0682',
		'Y2304-0683',
		'Y2304-0684',
		'Y2304-0693',
		'Y2304-1036',
		'Y2304-1054',
		'Y2304-1078',
		'Y2304-0458',
		'Y2304-0472',
		'Y2304-0473',
		'Y2304-0500',
		'Y2304-0505',
		'Y2304-0506',
		'Y2304-0510',
		'Y2304-0595',
		'Y2304-0630',
		'Y2304-0631',
		'Y2304-0632',
		'Y2304-0633',
		'Y2304-0988',
		'Y2304-1415',
		'Y2304-1076',
		'Y2304-0229',
		'Y2304-1146',
		'Y2305-0568B',
		'Y2305-0742',
		'Y2305-0995',
		'Y2304-1175',
		'Y2304-1176',
		'Y2304-1179',
		'Y2304-1180',
		'Y2304-1181',
		'Y2304-1182',
		'Y2304-1183',
		'Y2304-1185',
		'Y2304-1186',
		'Y2304-1187',
		'Y2304-1188',
		'Y2304-1190',
		'Y2304-1192',
		'Y2304-1193',
		'Y2304-1194',
		'Y2304-1196',
		'Y2304-1199',
		'Y2304-1200',
		'Y2304-1201',
		'Y2304-1202',
		'Y2304-1205',
		'Y2304-1209',
		'Y2304-1211',
		'Y2304-1212',
		'Y2304-1215',
		'Y2304-1216',
		'Y2304-1217',
		'Y2304-1218',
		'Y2304-1219',
		'Y2304-1220',
		'Y2304-1224',
		'Y2304-1226',
		'Y2304-1228',
		'Y2304-1229',
		'Y2304-1230',
		'Y2304-1231',
		'Y2304-1234',
		'Y2304-1236',
		'Y2304-1239',
		'Y2304-1240',
		'Y2304-1241',
		'Y2304-1242',
		'Y2304-1244',
		'Y2304-1249',
		'Y2304-1255',
		'Y2304-1258',
		'Y2304-1259',
		'Y2304-1261',
		'Y2304-1439',
		'Y2304-1440',
		'Y2304-1441',
		'Y2304-1442',
		'Y2305-0012',
		'Y2305-0013',
		'Y2305-0190',
		'Y2305-0200',
		'Y2305-0752',
		'Y2305-0757',
		'Y2305-0758',
		'Y2305-0760',
		'Y2305-0762',
		'Y2305-0763',
		'Y2305-0764',
		'Y2305-0765',
		'Y2305-0766',
		'Y2305-0830',
		'Y2305-0849',
		'Y2305-0897',
		'Y2305-0944',
		'Y2305-0945',
		'Y2305-0946',
		'Y2305-0947',
		'Y2305-0953',
		'Y2305-0954',
		'Y2305-0955',
		'Y2304-0656',
		'Y2304-0657',
		'Y2304-0747',
		'Y2304-0749',
		'Y2304-0751',
		'Y2304-0790',
		'Y2304-0791',
		'Y2304-1451',
		'Y2304-1494',
		'Y2304-1495',
		'Y2305-0017',
		'Y2305-0018',
		'Y2305-0019',
		'Y2305-0021',
		'Y2305-0022',
		'Y2305-0023',
		'Y2305-0024',
		'Y2305-0025',
		'Y2305-0026',
		'Y2305-0030',
		'Y2305-0032',
		'Y2305-0035',
		'Y2305-0036',
		'Y2305-0037',
		'Y2305-0038',
		'Y2305-0039',
		'Y2305-0040',
		'Y2305-0042',
		'Y2305-0052',
		'Y2305-0053',
		'Y2305-0054',
		'Y2305-0056',
		'Y2305-0058',
		'Y2305-0060',
		'Y2305-0061',
		'Y2305-0063',
		'Y2305-0067',
		'Y2305-0068',
		'Y2305-0070',
		'Y2305-0072',
		'Y2305-0073',
		'Y2305-0074',
		'Y2305-0075',
		'Y2305-0076',
		'Y2305-0077',
		'Y2305-0079',
		'Y2305-0199',
		'Y2305-0558',
		'Y2305-0559',
		'Y2305-0560',
		'Y2305-0561',
		'Y2305-0562',
		'Y2305-0563',
		'Y2305-1269',
		'Y2305-1278',
		'Y2305-1298',
		'Y2305-1299',
		'Y2305-1316',
		'Y2305-1324',
		'Y2304-0538',
		'Y2304-0539',
		'Y2304-0729',
		'Y2304-1475',
		'Y2305-0137',
		'Y2305-0193',
		'Y2303-0281D',
		'Y2303-0302C',
		'Y2303-0306D',
		'Y2305-0015',
		'Y2305-0016',
		'Y2305-0020',
		'Y2305-0055',
		'Y2305-0059',
		'Y2305-0062',
		'Y2305-0064',
		'Y2305-0078',
		'Y2305-0101',
		'Y2305-0107',
		'Y2305-0111',
		'Y2305-0113',
		'Y2305-0114',
		'Y2305-0115',
		'Y2305-0117',
		'Y2305-0119',
		'Y2305-0120',
		'Y2305-0121',
		'Y2305-0122',
		'Y2305-0126',
		'Y2305-0127',
		'Y2305-0128',
		'Y2305-0132',
		'Y2305-0133',
		'Y2305-0134',
		'Y2305-0135',
		'Y2305-0136',
		'Y2305-0138',
		'Y2305-0141',
		'Y2305-0142',
		'Y2305-0143',
		'Y2305-0144',
		'Y2305-0147',
		'Y2305-0148',
		'Y2305-0149',
		'Y2305-0152',
		'Y2305-0159',
		'Y2305-0176',
		'Y2305-0184',
		'Y2305-0788',
		'Y2305-0802',
		'Y2305-0827',
		'Y2305-0831',
		'Y2305-0850',
		'Y2304-1081',
		'Y2304-1082',
		'Y2304-1083',
		'Y2304-1084',
		'Y2304-1085',
		'Y2304-1086',
		'Y2304-1087',
		'Y2304-1088',
		'Y2304-1089',
		'Y2304-1090',
		'Y2304-1091',
		'Y2304-1092',
		'Y2304-1093',
		'Y2304-1095',
		'Y2304-1096',
		'Y2304-1097',
		'Y2304-1098',
		'Y2304-1099',
		'Y2304-1100',
		'Y2304-1101',
		'Y2304-1102',
		'Y2304-1103',
		'Y2304-1104',
		'Y2304-1105',
		'Y2304-1106',
		'Y2304-1107',
		'Y2304-1108',
		'Y2304-1109',
		'Y2304-1110',
		'Y2304-1111',
		'Y2305-0081',
		'Y2305-0082',
		'Y2305-0083',
		'Y2305-0084',
		'Y2305-0085',
		'Y2305-0088',
		'Y2305-0089',
		'Y2305-0090',
		'Y2305-0091',
		'Y2305-0094',
		'Y2305-0095',
		'Y2305-0096',
		'Y2305-0099',
		'Y2305-0100',
		'Y2305-0102',
		'Y2305-0105',
		'Y2305-0109',
		'Y2305-0110',
		'Y2305-0961',
		'Y2305-0968',
		'Y2305-0972',
		'Y2305-0976',
		'Y2305-0978',
		'Y2305-0993',
		'Y2305-0994',
		'Y2305-0011',
		'Y2305-0905',
		'Y2305-0985',
		'Y2305-0986',
		'Y2305-0987',
		'Y2304-1557',
		'Y2305-0745',
		'Y2208-0168',
		'Y2208-0169',
		'Y2208-0170',
		'Y2208-0176',
		'Y2208-0179',
		'Y2208-0180',
		'Y2208-0181',
		'Y2208-0182',
		'Y2208-0183',
		'Y2208-0184',
		'Y2208-0185',
		'Y2208-0188',
		'Y2209-0058',
		'Y2211-0011C',
		'Y2211-0015D',
		'Y2211-0047',
		'Y2211-0258',
		'Y2211-0260',
		'Y2211-0261',
		'Y2211-0262',
		'Y2211-0263',
		'Y2211-0266',
		'Y2211-0269',
		'Y2211-0274',
		'Y2211-0275',
		'Y2304-1177',
		'Y2304-1184',
		'Y2304-1189',
		'Y2304-1197',
		'Y2304-1203',
		'Y2304-1204',
		'Y2304-1207',
		'Y2304-1208',
		'Y2304-1210',
		'Y2304-1213',
		'Y2304-1214',
		'Y2304-1221',
		'Y2304-1223',
		'Y2304-1225',
		'Y2304-1227',
		'Y2304-1235',
		'Y2304-1237',
		'Y2304-1243',
		'Y2304-1245',
		'Y2304-1246',
		'Y2304-1247',
		'Y2304-1248',
		'Y2304-1250',
		'Y2304-1251',
		'Y2304-1256',
		'Y2304-1257',
		'Y2304-1260',
		'Y2304-1394',
		'Y2304-1395',
		'Y2304-1396',
		'Y2304-1397',
		'Y2304-1398',
		'Y2304-1399',
		'Y2304-1400',
		'Y2304-1401',
		'Y2304-1402',
		'Y2304-1403',
		'Y2304-1404',
		'Y2304-1405',
		'Y2305-0304',
		'Y2305-0314',
		'Y2305-0321',
		'Y2305-0326',
		'Y2305-0327',
		'Y2305-0328',
		'Y2305-0336',
		'Y2305-0338',
		'Y2305-0343',
		'Y2305-0344',
		'Y2305-0345',
		'Y2305-0354',
		'Y2305-0355',
		'Y2305-0356',
		'Y2305-0357',
		'Y2305-0358',
		'Y2305-0497',
		'Y2305-0498',
		'Y2305-0499',
		'Y2305-0500',
		'Y2305-0501',
		'Y2305-0505',
		'Y2305-0506',
		'Y2305-0508',
		'Y2305-0509',
		'Y2305-0510',
		'Y2305-0511',
		'Y2305-0512',
		'Y2305-0513',
		'Y2305-0515',
		'Y2305-1096',
		'Y2305-1097',
		'Y2305-1098',
		'Y2304-0072',
		'Y2304-0073',
		'Y2304-0075',
		'Y2304-0077',
		'Y2304-0078',
		'Y2304-0080',
		'Y2304-0081',
		'Y2304-0082',
		'Y2304-0083',
		'Y2304-0084',
		'Y2304-0499')
		Group by ddzl.khpo,old.yqty,ddzl.ddbh,YWCP.EXEDATE,ywdd.INSPECTDATE,DDZL.Pairs  )  as AA ) AA
	where AA.Diff>0 and AA.EXEDATE is not null ) A
where A.DDBH=YWDD.DDBH


------新增
Insert into rtstemp
Select * from (
Select 'LYN' as fsno,isnull(max(BDepartment.sumline),'') as sumline,ddzl.khpo
       ,'I' as GXLB,Convert(varchar,ywdd.INSPECTDATE,111)  as datadate
       ,(sum(ywdd.inspectqty)-isnull(old.yqty,0)) as qty ,ddzl.ddbh as ry, null as YN
from ywdd 
left join ddzl on ywdd.ysbh = ddzl.ddbh and ddzl.DDZT<>'C' 
left join (select YSBH,max(depno) as depno from SMDD where  GXLB='A'
group by YSBH) yp on yp.YSBH=DDZL.DDBH
left join BDepartment on BDepartment.id=yp.depno
left join 
  (select khpo,sum(qty) as yqty from rtstemp 
	 where gxlb='I' 
	 group by khpo) as old on old.khpo=ddzl.khpo 
where  1=1 
        and ddzl.khbh='036'
        and substring(ddzl.ddbh,1,2)<>'ZS'
		and YWDD.YSBH in ('Y2304-0464')
Group by ddzl.khpo,old.yqty,ddzl.ddbh,ywdd.INSPECTDATE  ) AA
where not exists ( 
    Select fsno 
	  from rtstemp 
where rtstemp.fsno=AA.fsno and rtstemp.sumline=AA.sumline and rtstemp.khpo=AA.KHPO and rtstemp.gxlb=AA.GXLB and rtstemp.datadate=AA.datadate and rtstemp.ry=AA.ry)

--更新
update rtstemp set Qty=rtstemp.Qty+AA.Qty
from (
Select * from (
Select 'LYN' as fsno,isnull(max(BDepartment.sumline),'') as sumline,ddzl.khpo
       ,'I' as GXLB,Convert(varchar,ywdd.INSPECTDATE,111)  as datadate
       ,(sum(ywdd.inspectqty)-isnull(old.yqty,0)) as qty ,ddzl.ddbh as ry, null as YN
from ywdd 
left join ddzl on ywdd.ysbh = ddzl.ddbh and ddzl.DDZT<>'C' 
left join (select YSBH,max(depno) as depno from SMDD where  GXLB='A'
group by YSBH) yp on yp.YSBH=DDZL.DDBH
left join BDepartment on BDepartment.id=yp.depno
left join 
  (select khpo,sum(qty) as yqty from rtstemp 
	 where gxlb='I' 
	 group by khpo) as old on old.khpo=ddzl.khpo 
where  1=1 
        and ddzl.khbh='036'
        and substring(ddzl.ddbh,1,2)<>'ZS'
		and YWDD.YSBH in ('Y2304-0464')
Group by ddzl.khpo,old.yqty,ddzl.ddbh,ywdd.INSPECTDATE  ) AA
where  exists ( 
    Select fsno 
	  from rtstemp 
where rtstemp.fsno=AA.fsno and rtstemp.sumline=AA.sumline and rtstemp.khpo=AA.KHPO and rtstemp.gxlb=AA.GXLB and rtstemp.datadate=AA.datadate and rtstemp.ry=AA.ry) and and qty>0 ) AA
where rtstemp.fsno=AA.fsno and rtstemp.sumline=AA.sumline and rtstemp.khpo=AA.KHPO and rtstemp.gxlb=AA.GXLB and rtstemp.datadate=AA.datadate and rtstemp.ry=AA.ry
-------


Select  DDZL.DDBH,DDZL.KHPO,DDZL.ShipDate,
        Max( Case when gxlb='O' then dataDate end) as EXEDate,
        Sum( Case when gxlb='C' then Qty end ) as 'Cutting',
		Sum( Case when gxlb='S' then Qty end ) as 'Cutting',
		Sum( Case when gxlb='A' then Qty end ) as 'Cutting',
		Sum( Case when gxlb='I' then Qty end ) as 'Cutting',
		Sum( Case when gxlb='O' then Qty end ) as 'Cutting'
from rtstemp
left join DDZL on DDZL.DDBH=rtstemp.ry
where rtstemp.RY  in (
'Y2304-0976',
'Y2304-0998',
'Y2303-0598',
'Y2304-0264',
'Y2304-0331',
'Y2304-0345',
'Y2304-0346',
'Y2304-0355',
'Y2304-0358',
'Y2304-0365',
'Y2304-0435',
'Y2304-0464',
'Y2303-0279C',
'Y2304-0268',
'Y2304-0418',
'Y2304-0420',
'Y2304-1384',
'Y2304-1556',
'Y2304-1577',
'Y2304-1578',
'Y2304-0516',
'Y2304-0543',
'Y2304-0552',
'Y2304-0332',
'Y2304-0005',
'Y2304-0006',
'Y2304-0061',
'Y2304-0062',
'Y2304-0063',
'Y2304-0064',
'Y2304-0065',
'Y2304-0320',
'Y2304-0397',
'Y2304-0453',
'Y2304-0618',
'Y2304-0702',
'Y2304-1080',
'Y2304-1263',
'Y2304-1264',
'Y2304-1266',
'Y2304-1268',
'Y2304-1270',
'Y2304-1272',
'Y2304-1273',
'Y2304-1274',
'Y2304-1275',
'Y2304-1278',
'Y2304-1279',
'Y2304-1281',
'Y2304-1282',
'Y2304-1283',
'Y2304-1288',
'Y2305-0303',
'Y2305-0305',
'Y2305-0306',
'Y2305-0308',
'Y2305-0309',
'Y2305-0310',
'Y2305-0311',
'Y2305-0312',
'Y2305-0315',
'Y2305-0317',
'Y2305-0318',
'Y2305-0322',
'Y2305-0329',
'Y2305-0330',
'Y2305-0331',
'Y2305-0334',
'Y2305-0335',
'Y2305-0337',
'Y2305-0339',
'Y2305-0341',
'Y2305-0342',
'Y2305-0347',
'Y2305-0349',
'Y2305-0350',
'Y2305-0351',
'Y2305-0352',
'Y2305-0353',
'Y2305-0361',
'Y2305-0362',
'Y2305-1099',
'Y2305-1100',
'Y2304-0606',
'Y2304-0607',
'Y2304-0617',
'Y2304-0619',
'Y2304-0620',
'Y2304-0622',
'Y2304-0623',
'Y2304-0624',
'Y2304-0625',
'Y2304-0626',
'Y2304-0627',
'Y2304-0629',
'Y2304-0638',
'Y2304-0639',
'Y2304-0640',
'Y2304-0641',
'Y2304-0642',
'Y2304-0643',
'Y2304-0644',
'Y2304-0645',
'Y2304-0646',
'Y2304-0647',
'Y2304-0648',
'Y2304-0649',
'Y2304-0650',
'Y2304-0651',
'Y2304-0652',
'Y2304-0653',
'Y2304-0658',
'Y2304-0659',
'Y2304-0660',
'Y2304-0661',
'Y2304-0662',
'Y2304-0665',
'Y2304-0667',
'Y2304-0668',
'Y2304-0669',
'Y2304-0670',
'Y2304-0671',
'Y2304-0672',
'Y2304-0673',
'Y2304-0675',
'Y2304-0678',
'Y2304-0679',
'Y2304-0680',
'Y2304-0682',
'Y2304-0683',
'Y2304-0684',
'Y2304-0693',
'Y2304-1036',
'Y2304-1054',
'Y2304-1078',
'Y2304-0458',
'Y2304-0472',
'Y2304-0473',
'Y2304-0500',
'Y2304-0505',
'Y2304-0506',
'Y2304-0510',
'Y2304-0595',
'Y2304-0630',
'Y2304-0631',
'Y2304-0632',
'Y2304-0633',
'Y2304-0635',
'Y2304-0987',
'Y2304-0988',
'Y2304-1407',
'Y2304-1408',
'Y2304-1415',
'Y2304-0384',
'Y2304-0877',
'Y2304-0883',
'Y2304-0914',
'Y2304-0916',
'Y2304-0917',
'Y2304-1076',
'Y2304-1141',
'Y2304-0229',
'Y2304-0241',
'Y2304-1146',
'Y2304-1516',
'Y2304-1523',
'Y2304-1533',
'Y2305-0732',
'Y2304-1573',
'Y2305-0568B',
'Y2305-0568F',
'Y2304-0616',
'Y2304-0767',
'Y2305-0963',
'Y2305-0742',
'Y2305-0995',
'Y2305-0997',
'Y2304-0228',
'Y2304-0380',
'Y2304-0433',
'Y2304-1175',
'Y2304-1176',
'Y2304-1179',
'Y2304-1180',
'Y2304-1181',
'Y2304-1182',
'Y2304-1183',
'Y2304-1185',
'Y2304-1186',
'Y2304-1187',
'Y2304-1188',
'Y2304-1190',
'Y2304-1192',
'Y2304-1193',
'Y2304-1194',
'Y2304-1196',
'Y2304-1199',
'Y2304-1200',
'Y2304-1201',
'Y2304-1202',
'Y2304-1205',
'Y2304-1209',
'Y2304-1211',
'Y2304-1212',
'Y2304-1215',
'Y2304-1216',
'Y2304-1217',
'Y2304-1218',
'Y2304-1219',
'Y2304-1220',
'Y2304-1224',
'Y2304-1226',
'Y2304-1228',
'Y2304-1229',
'Y2304-1230',
'Y2304-1231',
'Y2304-1234',
'Y2304-1236',
'Y2304-1239',
'Y2304-1240',
'Y2304-1241',
'Y2304-1242',
'Y2304-1244',
'Y2304-1249',
'Y2304-1255',
'Y2304-1258',
'Y2304-1259',
'Y2304-1261',
'Y2304-1439',
'Y2304-1440',
'Y2304-1441',
'Y2304-1442',
'Y2305-0012',
'Y2305-0013',
'Y2305-0150',
'Y2305-0190',
'Y2305-0200',
'Y2305-0752',
'Y2305-0757',
'Y2305-0758',
'Y2305-0760',
'Y2305-0762',
'Y2305-0763',
'Y2305-0764',
'Y2305-0765',
'Y2305-0766',
'Y2305-0828',
'Y2305-0830',
'Y2305-0849',
'Y2305-0867',
'Y2305-0868',
'Y2305-0887',
'Y2305-0897',
'Y2305-0925',
'Y2305-0941',
'Y2305-0944',
'Y2305-0945',
'Y2305-0946',
'Y2305-0947',
'Y2305-0953',
'Y2305-0954',
'Y2305-0955',
'YL2305-0002A',
'Y2304-0656',
'Y2304-0657',
'Y2304-0747',
'Y2304-0749',
'Y2304-0751',
'Y2304-0790',
'Y2304-0791',
'Y2304-1451',
'Y2304-1494',
'Y2304-1495',
'Y2305-0017',
'Y2305-0018',
'Y2305-0019',
'Y2305-0021',
'Y2305-0022',
'Y2305-0023',
'Y2305-0024',
'Y2305-0025',
'Y2305-0026',
'Y2305-0027',
'Y2305-0028',
'Y2305-0030',
'Y2305-0032',
'Y2305-0035',
'Y2305-0036',
'Y2305-0037',
'Y2305-0038',
'Y2305-0039',
'Y2305-0040',
'Y2305-0042',
'Y2305-0044',
'Y2305-0046',
'Y2305-0048',
'Y2305-0052',
'Y2305-0053',
'Y2305-0054',
'Y2305-0056',
'Y2305-0058',
'Y2305-0060',
'Y2305-0061',
'Y2305-0063',
'Y2305-0065',
'Y2305-0067',
'Y2305-0068',
'Y2305-0070',
'Y2305-0072',
'Y2305-0073',
'Y2305-0074',
'Y2305-0075',
'Y2305-0076',
'Y2305-0077',
'Y2305-0079',
'Y2305-0199',
'Y2305-0558',
'Y2305-0559',
'Y2305-0560',
'Y2305-0561',
'Y2305-0562',
'Y2305-0563',
'Y2305-1265',
'Y2305-1269',
'Y2305-1278',
'Y2305-1283',
'Y2305-1298',
'Y2305-1299',
'Y2305-1316',
'Y2305-1317',
'Y2305-1320',
'Y2305-1324',
'Y2305-1330',
'Y2304-0538',
'Y2304-0539',
'Y2304-0729',
'Y2304-1475',
'Y2305-0014',
'Y2305-0137',
'Y2305-0193',
'Y2303-0278E',
'Y2303-0281D',
'Y2303-0302C',
'Y2303-0306D',
'Y2305-0015',
'Y2305-0016',
'Y2305-0020',
'Y2305-0055',
'Y2305-0059',
'Y2305-0062',
'Y2305-0064',
'Y2305-0078',
'Y2305-0087',
'Y2305-0093',
'Y2305-0101',
'Y2305-0107',
'Y2305-0111',
'Y2305-0113',
'Y2305-0114',
'Y2305-0115',
'Y2305-0117',
'Y2305-0118',
'Y2305-0119',
'Y2305-0120',
'Y2305-0121',
'Y2305-0122',
'Y2305-0126',
'Y2305-0127',
'Y2305-0128',
'Y2305-0129',
'Y2305-0132',
'Y2305-0133',
'Y2305-0134',
'Y2305-0135',
'Y2305-0136',
'Y2305-0138',
'Y2305-0141',
'Y2305-0142',
'Y2305-0143',
'Y2305-0144',
'Y2305-0147',
'Y2305-0148',
'Y2305-0149',
'Y2305-0152',
'Y2305-0159',
'Y2305-0164',
'Y2305-0176',
'Y2305-0184',
'Y2305-0788',
'Y2305-0802',
'Y2305-0817',
'Y2305-0827',
'Y2305-0831',
'Y2305-0841',
'Y2305-0850',
'Y2305-0857',
'Y2305-0858',
'Y2305-0865',
'Y2305-0998',
'Y2304-1081',
'Y2304-1082',
'Y2304-1083',
'Y2304-1084',
'Y2304-1085',
'Y2304-1086',
'Y2304-1087',
'Y2304-1088',
'Y2304-1089',
'Y2304-1090',
'Y2304-1091',
'Y2304-1092',
'Y2304-1093',
'Y2304-1095',
'Y2304-1096',
'Y2304-1097',
'Y2304-1098',
'Y2304-1099',
'Y2304-1100',
'Y2304-1101',
'Y2304-1102',
'Y2304-1103',
'Y2304-1104',
'Y2304-1105',
'Y2304-1106',
'Y2304-1107',
'Y2304-1108',
'Y2304-1109',
'Y2304-1110',
'Y2304-1111',
'Y2305-0081',
'Y2305-0082',
'Y2305-0083',
'Y2305-0084',
'Y2305-0085',
'Y2305-0088',
'Y2305-0089',
'Y2305-0090',
'Y2305-0091',
'Y2305-0094',
'Y2305-0095',
'Y2305-0096',
'Y2305-0099',
'Y2305-0100',
'Y2305-0102',
'Y2305-0105',
'Y2305-0109',
'Y2305-0110',
'Y2305-0961',
'Y2305-0967',
'Y2305-0968',
'Y2305-0972',
'Y2305-0976',
'Y2305-0978',
'Y2305-0993',
'Y2305-0994',
'Y2305-0011',
'Y2305-0905',
'Y2305-0914',
'Y2305-0915',
'Y2305-0985',
'Y2305-0986',
'Y2305-0987',
'Y2304-1557',
'Y2305-0745',
'Y2208-0168',
'Y2208-0169',
'Y2208-0170',
'Y2208-0176',
'Y2208-0179',
'Y2208-0180',
'Y2208-0181',
'Y2208-0182',
'Y2208-0183',
'Y2208-0184',
'Y2208-0185',
'Y2208-0188',
'Y2209-0058',
'Y2211-0011C',
'Y2211-0015D',
'Y2211-0047',
'Y2211-0258',
'Y2211-0260',
'Y2211-0261',
'Y2211-0262',
'Y2211-0263',
'Y2211-0266',
'Y2211-0269',
'Y2211-0274',
'Y2211-0275',
'Y2304-1177',
'Y2304-1184',
'Y2304-1189',
'Y2304-1197',
'Y2304-1203',
'Y2304-1204',
'Y2304-1207',
'Y2304-1208',
'Y2304-1210',
'Y2304-1213',
'Y2304-1214',
'Y2304-1221',
'Y2304-1223',
'Y2304-1225',
'Y2304-1227',
'Y2304-1233',
'Y2304-1235',
'Y2304-1237',
'Y2304-1243',
'Y2304-1245',
'Y2304-1246',
'Y2304-1247',
'Y2304-1248',
'Y2304-1250',
'Y2304-1251',
'Y2304-1254',
'Y2304-1256',
'Y2304-1257',
'Y2304-1260',
'Y2304-1394',
'Y2304-1395',
'Y2304-1396',
'Y2304-1397',
'Y2304-1398',
'Y2304-1399',
'Y2304-1400',
'Y2304-1401',
'Y2304-1402',
'Y2304-1403',
'Y2304-1404',
'Y2304-1405',
'Y2305-0304',
'Y2305-0314',
'Y2305-0321',
'Y2305-0326',
'Y2305-0327',
'Y2305-0328',
'Y2305-0336',
'Y2305-0338',
'Y2305-0343',
'Y2305-0344',
'Y2305-0345',
'Y2305-0354',
'Y2305-0355',
'Y2305-0356',
'Y2305-0357',
'Y2305-0358',
'Y2305-0360',
'Y2305-0497',
'Y2305-0498',
'Y2305-0499',
'Y2305-0500',
'Y2305-0501',
'Y2305-0505',
'Y2305-0506',
'Y2305-0508',
'Y2305-0509',
'Y2305-0510',
'Y2305-0511',
'Y2305-0512',
'Y2305-0513',
'Y2305-0515',
'Y2305-1096',
'Y2305-1097',
'Y2305-1098',
'Y2304-0072',
'Y2304-0073',
'Y2304-0075',
'Y2304-0077',
'Y2304-0078',
'Y2304-0080',
'Y2304-0081',
'Y2304-0082',
'Y2304-0083',
'Y2304-0084',
'Y2304-0499',
'Y2304-0502',
'Y2305-1331'
)

Group by DDZL.DDBH,DDZL.KHPO,DDZL.ShipDate
